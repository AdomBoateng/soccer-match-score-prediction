# Project Title: Soccer Match Score Prediction

## Description

This project involves predicting the scores of soccer matches using machine learning techniques. The dataset contains historical match data, and the objective is to train a model that can predict the home team's score based on several features such as the home team, away team, and tournament type.

The project leverages Python's `pandas` for data manipulation, `scikit-learn` for model building and evaluation, and `numpy` for numerical operations. The model pipeline includes preprocessing steps such as handling missing values, encoding categorical variables, and a `RandomForestRegressor` for the prediction task.

## Requirements

To run this project, you will need the following packages installed:

- Python 3.6 or later
- `numpy`
- `pandas`
- `scikit-learn`

Dataset can be downloaded from [results.csv](https://www.kaggle.com/datasets/martj42/international-football-results-from-1872-to-2017)

You can install the required packages using `pip`:

```bash
pip install numpy pandas scikit-learn
```

## Code Overview

### Step 1: Importing Libraries

The necessary libraries are imported at the beginning:

```python
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.ensemble import RandomForestRegressor
```

### Step 2: Reading the Dataset

The dataset `results.csv` is read into a pandas DataFrame:

```python
df = pd.read_csv('results.csv')
```

### Step 3: Handling Missing Values

Missing values in the dataset are dropped:

```python
df = df.dropna()
```

### Step 4: Feature Engineering

A new feature `home_away_diff` is created to represent the difference between home and away scores:

```python
if 'home_score' in df.columns:
    df['home_away_diff'] = df['home_score'] - df['away_score']
    X = df[['home_team', 'away_team', 'tournament', 'home_away_diff']]
    y = df['home_score']
else:
    print("'home_score' column is missing from the dataset.")
```

### Step 5: Splitting the Dataset

The dataset is split into training and testing sets:

```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
```

### Step 6: Building the Model Pipeline

A pipeline is constructed to preprocess the data and train the model. Categorical features are handled using `OneHotEncoder` and `SimpleImputer`, and a `RandomForestRegressor` is used for prediction:

```python
categorical_features = ['home_team', 'away_team', 'tournament', 'home_away_diff']
categorical_transformer = Pipeline(steps=[
    ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),
    ('onehot', OneHotEncoder(handle_unknown='ignore'))
])

preprocessor = ColumnTransformer(
    transformers=[
        ('cat', categorical_transformer, categorical_features)
    ])

model = Pipeline(steps=[
    ('preprocessor', preprocessor),
    ('regressor', RandomForestRegressor())
])
```

### Step 7: Training the Model

The model is trained using the training dataset:

```python
model.fit(X_train, y_train)
```

### Step 8: Evaluating the Model

The model's performance is evaluated using Mean Squared Error (MSE) and R-squared metrics:

```python
y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f'Mean Squared Error: {mse}')
print(f'R-squared: {r2}')
```

### Step 9: Making Predictions on New Data

The model is used to make predictions on new data points:

```python
new_data = {
    'home_team': ['Spain', 'Germany', 'Hungary'],
    'away_team': ['Croatia', 'Scotland', 'Switzerland'],
    'tournament': ['Euros', 'Euros', 'Euros'],
    'home_away_diff': [0, 0, 0]
}
new_df = pd.DataFrame(new_data)

new_data_preprocessed = model.named_steps['preprocessor'].transform(new_df)
new_predictions = model.named_steps['regressor'].predict(new_data_preprocessed)

for i, prediction in enumerate(new_predictions):
    print("Prediction for new data point {}: {:.2f}".format(i + 1, prediction))
```

## Example Predictions

The model can predict outcomes for new matchups, such as:

- Spain vs. Croatia
- Germany vs. Scotland
- Hungary vs. Switzerland

## Author

This README was generated by Gideon Adom Boateng with the assistance of ChatGPT.# Project Title: Soccer Match Score Prediction

## Description

This project involves predicting the scores of soccer matches using machine learning techniques. The dataset contains historical match data, and the objective is to train a model that can predict the home team's score based on several features such as the home team, away team, and tournament type.

The project leverages Python's `pandas` for data manipulation, `scikit-learn` for model building and evaluation, and `numpy` for numerical operations. The model pipeline includes preprocessing steps such as handling missing values, encoding categorical variables, and a `RandomForestRegressor` for the prediction task.

## Requirements

To run this project, you will need the following packages installed:

- Python 3.6 or later
- `numpy`
- `pandas`
- `scikit-learn`

You can install the required packages using `pip`:

```bash
pip install numpy pandas scikit-learn
```

## Code Overview

### Step 1: Importing Libraries

The necessary libraries are imported at the beginning:

```python
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error, r2_score
from sklearn.preprocessing import OneHotEncoder
from sklearn.compose import ColumnTransformer
from sklearn.pipeline import Pipeline
from sklearn.impute import SimpleImputer
from sklearn.ensemble import RandomForestRegressor
```

### Step 2: Reading the Dataset

The dataset `results.csv` is read into a pandas DataFrame:

```python
df = pd.read_csv('results.csv')
```

### Step 3: Handling Missing Values

Missing values in the dataset are dropped:

```python
df = df.dropna()
```

### Step 4: Feature Engineering

A new feature `home_away_diff` is created to represent the difference between home and away scores:

```python
if 'home_score' in df.columns:
    df['home_away_diff'] = df['home_score'] - df['away_score']
    X = df[['home_team', 'away_team', 'tournament', 'home_away_diff']]
    y = df['home_score']
else:
    print("'home_score' column is missing from the dataset.")
```

### Step 5: Splitting the Dataset

The dataset is split into training and testing sets:

```python
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
```

### Step 6: Building the Model Pipeline

A pipeline is constructed to preprocess the data and train the model. Categorical features are handled using `OneHotEncoder` and `SimpleImputer`, and a `RandomForestRegressor` is used for prediction:

```python
categorical_features = ['home_team', 'away_team', 'tournament', 'home_away_diff']
categorical_transformer = Pipeline(steps=[
    ('imputer', SimpleImputer(strategy='constant', fill_value='missing')),
    ('onehot', OneHotEncoder(handle_unknown='ignore'))
])

preprocessor = ColumnTransformer(
    transformers=[
        ('cat', categorical_transformer, categorical_features)
    ])

model = Pipeline(steps=[
    ('preprocessor', preprocessor),
    ('regressor', RandomForestRegressor())
])
```

### Step 7: Training the Model

The model is trained using the training dataset:

```python
model.fit(X_train, y_train)
```

### Step 8: Evaluating the Model

The model's performance is evaluated using Mean Squared Error (MSE) and R-squared metrics. The MSE score was **0.6590148563549776** and the R-squared score was **0.6525418214017057**:

```python
y_pred = model.predict(X_test)
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f'Mean Squared Error: {mse}')
print(f'R-squared: {r2}')
```

### Step 9: Making Predictions on New Data

The model is used to make predictions on new data points:

```python
new_data = {
    'home_team': ['Spain', 'Germany', 'Hungary'],
    'away_team': ['Croatia', 'Scotland', 'Switzerland'],
    'tournament': ['Euros', 'Euros', 'Euros'],
    'home_away_diff': [0, 0, 0]
}
new_df = pd.DataFrame(new_data)

new_data_preprocessed = model.named_steps['preprocessor'].transform(new_df)
new_predictions = model.named_steps['regressor'].predict(new_data_preprocessed)

for i, prediction in enumerate(new_predictions):
    print("Prediction for new data point {}: {:.2f}".format(i + 1, prediction))
```

## Example Predictions

The model can predict outcomes for new matchups, such as:

- Spain vs. Croatia
- Germany vs. Scotland
- Hungary vs. Switzerland

## Author

This README was generated with the assistance of ChatGPT.